<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TrailFinder</title>
    <script src="https://code.jquery.com/jquery-1.12.4.js"></script>
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
    <link rel="stylesheet" href="//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
    <link rel="stylesheet" th:href="@{/css/style.css}">
</head>
<body>

<div th:replace="fragments/topnav :: navbar"></div>

<h2>Trail Finder</h2>

<div class="container">
    <form id="search-form" method="POST">
        <div class="form-floating mb-3">
            <input type="text" class="form-control" id="floatingInput" name="search_query" placeholder="x" required>
            <label for="floatingInput">Find trails by zipcode, difficulty, type, or name</label>
            <input type="submit" class="btn btn-success" value="Submit">
        </div>
    </form>
</div>

<div class="center-table">
    <table id="trail-table" class="table-bordered table table-hover table-secondary">
        <tr id="header-row" class="table-primary" style="display: none;">
            <td><b>Name</b></td>
            <td><b>Type</b></td>
            <td><b>Difficulty</b></td>
            <td><b>Address</b></td>
            <td><b>Zip Code</b></td>
            <td><b>Temperature</b></td>
        </tr>
        <tr id="trail-row" th:each="trail : ${trailData}">
            <td th:text="${trail.value.name}"></td>
            <td th:text="${trail.value.trailType}"></td>
            <td th:text="${trail.value.difficulty}"></td>
            <td th:text="${trail.value.address}"></td>
            <td th:text="${trail.value.zipCode}"></td>
            <td th:text="*{trail.key + 'Â°F'}"></td>
        </tr>
    </table>
</div>


<script type="text/javascript">
    $(function () {
        $("#floatingInput").autocomplete({
            source: ["Forrest Park", "Beechwood, Furnas, Ponderosa, and Red Oak Trail", "Stone Steps Loop", "French Park", "Ault Forest Loop Trail", "Bender Mountain Loop Trail", "Hiking", "Moderate", "Easy", "Hard", "45211", "45212", "45213", "45214", "45215"],
            minLength: 1
        });

        $("#search-form").submit(function (event) {
            event.preventDefault(); // Prevent the form from submitting normally

            // Get the user's input
            var userInput = $("#floatingInput").val();

            // List of trail names / search queries
            var trailNames = [
                "Forrest Park",
                "Beechwood, Furnas, Ponderosa, and Red Oak Trail",
                "Stone Steps Loop",
                "French Park",
                "Ault Forest Loop Trail",
                "Bender Mountain Loop Trail",
                "Hiking",
                "Easy",
                "Moderate",
                "Hard",
                "45211",
                "45212",
                "45213",
                "45214",
                "45215"
                // Add more trail names here
            ];

            // Show the table
            $("#trail-table").show();

            // Hide rows that don't match the user's input
            $("#trail-table tbody tr").each(function () {
                var trailRow = $(this);
                var shouldShow = false;

                // Show the header row
                $("#header-row").show();

                // Check each cell in the row for a match with user input
                trailRow.find("td").each(function () {
                    if ($(this).text().toLowerCase().includes(userInput.toLowerCase())) {
                        shouldShow = true;
                        return false; // Break the loop
                    }
                });

                if (shouldShow) {
                    trailRow.show();
                } else {
                    trailRow.hide();
                }
            });
        });
    });
</script>

<a th:href="@{/Login}" id="status-indicator" class="status-indicator">
    Status: <span id="status-text">Loading...</span>
    <span id="username-text"></span>
</a>

<script th:src="@{/js/LoginStatus.js}"></script>
</body>
</html>